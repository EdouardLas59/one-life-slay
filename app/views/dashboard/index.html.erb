<div class="container">
  <div style="text-align: center; color: white">
    <h1> My Profil </h1>
  </div>

  <div class="filter-bar p-5">
    <div class="scroll-nav">
      <a href="#available-movies">Available for Rent</a>
      <a href="#rented-out-movies">Movies I own that I am renting</a>
      <a href="#rented-movies">Movies I have rented</a>
    </div>
  </div>

  <h2 id="available-movies">Movies I own and available for rent</h2>
  <ul class="movie-listdash">
    <% current_user.movies.each do |movie| %>
      <% if movie.bookings.size == 0 %>
        <li class="movie-itemdash">
          <div class="movie-posterdash">
            <%= image_tag(movie.poster_url, alt: "#{movie.title} poster", class: "posterdash") if movie.poster_url.present? %>
          </div>
          <div class="movie-detailsdash">
            <p><strong>Title:</strong> <%= movie.title %></p>
            <p><strong>Year:</strong> <%= movie.year %></p>
            <p><strong>Genre:</strong> <%= movie.genre %></p>
          </div>
          <%= link_to "delete", movie_path(movie), data: { turbo_method: :delete, turbo_confirm: "Are you sure you want to remove #{movie.title}"} %>
        </li>
      <% end %>
    <% end %>
  </ul>

  <h2 id="rented-out-movies">Movies I own that I am renting</h2>
  <ul class="movie-listdash">
    <% current_user.movies.each do |movie| %>
      <% if movie.bookings.size > 0 %>
        <li class="movie-itemdash">
          <div class="movie-posterdash">
            <%= image_tag(movie.poster_url, alt: "#{movie.title} poster", class: "posterdash") if movie.poster_url.present? %>
          </div>
          <div class="movie-detailsdash">
            <p><strong>Title:</strong> <%= movie.title %></p>
            <p><strong>Rented From:</strong> <%= movie.bookings.first.date_start %> to <%= movie.bookings.first.date_end %></p>
          </div>
          <%= link_to "delete", booking_path(booking), data: { turbo_method: :delete, turbo_confirm: "Are you sure you want to remove it"} %>
        </li>
      <% end %>
    <% end %>
  </ul>

  <h2 id="rented-movies">Movies I have rented</h2>
  <ul class="movie-listdash">
    <% current_user.bookings.each do |booking| %>
      <li class="movie-itemdash">
        <div class="movie-posterdash">
          <%= image_tag(booking.movie.poster_url, alt: "#{booking.movie.title} poster", class: "posterdash") if booking.movie.poster_url.present? %>
        </div>
        <div class="movie-detailsdash">
          <p><strong>Title:</strong> <%= booking.movie.title %></p>
          <p><strong>Review:</strong> <%= booking.movie.review %></p>
          <p><strong>Rented From:</strong> <%= booking.date_start %> to <%= booking.date_end %></p>
        </div>
        <%= link_to "delete", booking_path(booking), data: { turbo_method: :delete, turbo_confirm: "Are you sure you want to remove it"} %>
      </li>
    <% end %>
  </ul>
</div>
<script>
  window.onload = function() {
    var imgSrc = "https://images4.alphacoders.com/134/1340419.png"; // URL de l'image
    var speed = 1; // Vitesse du défilement
    var scale = 1; // Facteur de mise à l'échelle de l'image

    // Sélectionner l'élément body pour l'arrière-plan animé
    var bodyElement = document.body;
    var x = 0; // Position de départ du défilement

    // Fonction qui gère l'animation de l'image en fond
    function animateBackground() {
      // Mettre à jour la position du background
      bodyElement.style.backgroundPositionX = x + 'px';

      // Modifier la position pour créer l'effet de défilement
      x -= speed;

      // Si l'image a complètement défilé, recommencer
      if (x <= -bodyElement.offsetWidth) {
        x = 0;
      }
    }

    // Appliquer l'image en fond et démarrer l'animation
    bodyElement.style.backgroundImage = 'url(' + imgSrc + ')';
    bodyElement.style.backgroundRepeat = 'repeat-x'; // Répéter l'image horizontalement
    bodyElement.style.backgroundSize = "contain";
    bodyElement.style.backgroundAttachment = 'fixed'; // L'image reste fixe lors du défilement de la page
    setInterval(animateBackground, 20);
  };
</script>
